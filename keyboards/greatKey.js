const { Telegraf, Markup, Scenes, session } = require('telegraf');
const bot = require('../config/config');
const { searchCommand } = require('./searchKey');

const startCommand = async (ctx) => {
    console.log('ÐŸÐ¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒ Ð·Ð°Ð¿ÑƒÑÑ‚Ð¸Ð» Ð±Ð¾Ñ‚Ð°');

    try {

        ctx.session = {}; // ÐžÐ±Ð½ÑƒÐ»ÑÐµÐ¼ Ð²ÑÑŽ ÑÐµÑÑÐ¸ÑŽ
        // Ð•ÑÐ»Ð¸ Ð²Ñ‹ Ñ…Ð¾Ñ‚Ð¸Ñ‚Ðµ Ð¾Ð±Ð½ÑƒÐ»Ð¸Ñ‚ÑŒ Ñ‚Ð¾Ð»ÑŒÐºÐ¾ Ð¾Ð¿Ñ€ÐµÐ´ÐµÐ»ÐµÐ½Ð½Ñ‹Ðµ Ð´Ð°Ð½Ð½Ñ‹Ðµ ÑÐµÑÑÐ¸Ð¸:
        ctx.session.genderChoice = null;
        // ÐžÑ‚Ð¿Ñ€Ð°Ð²Ð»ÑÐµÐ¼ Ð¸Ð·Ð¾Ð±Ñ€Ð°Ð¶ÐµÐ½Ð¸Ðµ Ñ ÐºÐ»Ð°Ð²Ð¸Ð°Ñ‚ÑƒÑ€Ð¾Ð¹ Ð¸ Ñ‚ÐµÐºÑÑ‚Ð¾Ð¼ Ð¿Ñ€Ð¸Ð²ÐµÑ‚ÑÑ‚Ð²Ð¸Ñ
        const imageUrl = 'https://raw.githubusercontent.com/ospreystudio/photo-gallery/main/logo.jpg';
        await ctx.replyWithPhoto({ url: imageUrl });

        // Ð—Ð°Ñ‚ÐµÐ¼ Ð¾Ñ‚Ð¿Ñ€Ð°Ð²Ð»ÑÐµÐ¼ Ñ‚ÐµÐºÑÑ‚ Ð¿Ñ€Ð¸Ð²ÐµÑ‚ÑÑ‚Ð²Ð¸Ñ Ð¸ ÐºÐ»Ð°Ð²Ð¸Ð°Ñ‚ÑƒÑ€Ñƒ
        await ctx.reply("ÐŸÑ€Ð¸Ð²ÐµÑ‚! â€ðŸ’«  \n \nÐ’Ð°Ñ Ð¿Ñ€Ð¸Ð²ÐµÑ‚ÑÑ‚Ð²ÑƒÐµÑ‚ Ð±Ð¾Ñ‚ Ð·Ð½Ð°ÐºÐ¾Ð¼ÑÑ‚Ð² DateBeautyBot ðŸ’Ÿ \n \nÐ•ÑÐ»Ð¸ Ð’Ð°Ð¼ ÑƒÐ¶Ðµ 18 Ð»ÐµÑ‚ Ð¸Ð»Ð¸ Ð±Ð¾Ð»ÑŒÑˆÐµ, Ñ‚Ð¾ Ð½Ð°Ñ‡Ð¸Ð½Ð°Ð¹Ñ‚Ðµ Ð·Ð°Ð¿Ð¾Ð»Ð½ÑÑ‚ÑŒ Ð°Ð½ÐºÐµÑ‚Ñƒ Ð¸ Ð·Ð°Ð²Ð¾Ð´Ð¸Ñ‚ÑŒ Ð½Ð¾Ð²Ñ‹Ñ… Ð´Ñ€ÑƒÐ·ÐµÐ¹! ðŸ”ž \n \nÐ’Ð½Ð¸Ð¼Ð°Ð½Ð¸Ðµ! âš ï¸ \n \nÐ•ÑÐ»Ð¸ Ð²Ð¾ Ð²Ñ€ÐµÐ¼Ñ Ð¿Ñ€Ð¾ÑÐ¼Ð¾Ñ‚Ñ€Ð° Ð°Ð½ÐºÐµÑ‚ Ñƒ Ð²Ð°Ñ ÑÐ»ÑƒÑ‡Ð¸Ð»ÑÑ Ð±Ð°Ð³ Ð¸Ð»Ð¸ Ð±Ð¾Ñ‚ Ð·Ð°Ð²Ð¸Ñ, Ñ‚Ð¾ Ð²Ð¾ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐ¹Ñ‚ÐµÑÑŒ ÐºÐ¾Ð¼Ð°Ð½Ð´Ð¾Ð¹ /start ðŸš€" +
            "\n \nÐ”Ð°Ð²Ð°Ð¹Ñ‚Ðµ Ð½Ð°Ñ‡Ð½ÐµÐ¼ Ð·Ð½Ð°ÐºÐ¾Ð¼Ð¸Ñ‚ÑŒÑÑ ðŸ’‘" +
            "\n \nÐ¡Ð½Ð°Ñ‡Ð°Ð»Ð° Ð¾Ð¿Ñ€ÐµÐ´ÐµÐ»Ð¸Ñ‚Ðµ ÑÐ²Ð¾Ð¹ Ð¿Ð¾Ð»  ðŸ‘¤",
            Markup.inlineKeyboard([ // ÐžÐ±Ñ€Ð°Ð±Ð¾Ñ‚Ñ‡Ð¸ÐºÐ¸ ÐºÐ½Ð¾Ð¿Ð¾Ðº
                Markup.button.callback('ÐŸÐ°Ñ€ÐµÐ½ÑŒ  ðŸ‘¨', 'man'),
                Markup.button.callback('Ð”ÐµÐ²ÑƒÑˆÐºÐ°  ðŸ‘±', 'woman'),
            ])
        );
    } catch (error) {
        console.error('ÐŸÑ€Ð¾Ð¸Ð·Ð¾ÑˆÐ»Ð° Ð¾ÑˆÐ¸Ð±ÐºÐ°:', error);
        ctx.reply('ÐŸÑ€Ð¾Ð¸Ð·Ð¾ÑˆÐ»Ð° Ð¾ÑˆÐ¸Ð±ÐºÐ° Ð¿Ñ€Ð¸ Ð·Ð°Ð³Ñ€ÑƒÐ·ÐºÐµ ÐºÐ°Ñ€Ñ‚Ð¸Ð½ÐºÐ¸ Ð¸Ð»Ð¸ Ð¾Ñ‚Ð¿Ñ€Ð°Ð²ÐºÐµ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ñ.');
    }
};
bot.action('man', (ctx) => {
        searchCommand(ctx)
});

bot.action('woman', (ctx) => {
        searchCommand(ctx)
});

module.exports = { startCommand };